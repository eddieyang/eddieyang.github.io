<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WebView ä¸‹è¼‰æ¸¬è©¦</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        margin: 0;
        padding: 40px;
        background-color: #f5f5f5;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 30px;
      }

      h1 {
        color: #333;
        text-align: center;
        margin-bottom: 40px;
      }

      .download-btn {
        display: block;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 15px 30px;
        border-radius: 8px;
        text-decoration: none;
        font-weight: 500;
        font-size: 16px;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        border: none;
        cursor: pointer;
        width: 320px;
        text-align: center;
        box-sizing: border-box;
      }

      .download-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
      }

      .download-btn:active {
        transform: translateY(0);
      }

      .btn-container {
        display: flex;
        flex-direction: column;
        gap: 20px;
        align-items: center;
      }

      .btn-label {
        color: #666;
        font-size: 14px;
        margin-bottom: 5px;
      }
    </style>
  </head>
  <body>
    <h1>WebView ä¸‹è¼‰åŠŸèƒ½æ¸¬è©¦</h1>

    <div class="btn-container">
      <div>
        <div class="btn-label">æŒ‰éˆ•1ï¼šä¸‹è¼‰é ç«¯åœ–ç‰‡</div>
        <a
          href="https://images.5943920202.com/mcs-images/announcement/we999bdtf5/1739807012668_New%20member%20challenge.jpeg"
          download="new_member_challenge.jpeg"
          class="download-btn"
        >
          ä¸‹è¼‰é ç«¯åœ–ç‰‡
        </a>
      </div>

      <div>
        <div class="btn-label">æŒ‰éˆ•2ï¼šä¸‹è¼‰ Canvas åœ–ç‰‡</div>
        <a href="#" id="canvasDownloadBtn" class="download-btn">ä¸‹è¼‰ Canvas åœ–ç‰‡</a>
      </div>

      <div>
        <div class="btn-label">æŒ‰éˆ•3ï¼šä¸‹è¼‰ Blob + TXT</div>
        <button id="blobDownloadBtn" class="download-btn">ä¸‹è¼‰ Blob + TXT</button>
      </div>

      <div>
        <div class="btn-label">æŒ‰éˆ•4ï¼šä¸‹è¼‰ Blob + Image</div>
        <button id="blobImageDownloadBtn" class="download-btn">ä¸‹è¼‰ Blob + Image + Canvas</button>
      </div>

      <div>
        <div class="btn-label">æŒ‰éˆ•5ï¼šä¸‹è¼‰ Blob + JSON</div>
        <button id="blobJsonDownloadBtn" class="download-btn">ä¸‹è¼‰ Blob + JSON</button>
      </div>
    </div>

    <script>
      // å‰µå»º Canvas ä¸¦ç•«åœ–
      function createCanvasImage() {
        const canvas = document.createElement("canvas");
        canvas.width = 100;
        canvas.height = 100;
        const ctx = canvas.getContext("2d");

        // è¨­ç½®èƒŒæ™¯è‰²
        ctx.fillStyle = "#f0f0f0";
        ctx.fillRect(0, 0, 100, 100);

        // ç•«é‚Šæ¡†
        ctx.strokeStyle = "#333";
        ctx.lineWidth = 2;
        ctx.strokeRect(0, 0, 100, 100);

        // å¯«æ–‡å­— "123"
        ctx.fillStyle = "#333";
        ctx.font = "24px Arial";
        ctx.textAlign = "center";
        ctx.textBaseline = "middle";
        ctx.fillText("123", 50, 50);

        // è½‰æˆ base64
        return canvas.toDataURL("image/png");
      }

      // ç‚ºæŒ‰éˆ•2æ·»åŠ é»æ“Šäº‹ä»¶
      document.getElementById("canvasDownloadBtn").addEventListener("click", function (e) {
        e.preventDefault();
        const base64Image = createCanvasImage();

        // å‰µå»ºä¸‹è¼‰é€£çµ
        const link = document.createElement("a");
        link.href = base64Image;
        link.download = "canvas-123.png";
        link.click();
      });

      // ç‚ºæŒ‰éˆ•3æ·»åŠ é»æ“Šäº‹ä»¶
      document.getElementById("blobDownloadBtn").addEventListener("click", function (e) {
        e.preventDefault();
        
        // å‰µå»ºæ–‡å­—å…§å®¹
        const textContent = `é€™æ˜¯ä¸€å€‹æ¸¬è©¦æ–‡ä»¶
æ™‚é–“ï¼š${new Date().toLocaleString()}
å…§å®¹ï¼šWebView ä¸‹è¼‰æ¸¬è©¦
åŠŸèƒ½ï¼šBlob + TXT ä¸‹è¼‰
æè¿°ï¼šä½¿ç”¨ Blob API å‰µå»ºä¸¦ä¸‹è¼‰æ–‡å­—æª”æ¡ˆ

æ¸¬è©¦é …ç›®ï¼š
1. æ–‡å­—ç·¨ç¢¼æ¸¬è©¦
2. ä¸­æ–‡å­—ç¬¦æ”¯æ´
3. ç‰¹æ®Šç¬¦è™Ÿï¼š!@#$%^&*()
4. æ•¸å­—ï¼š123456789
5. è‹±æ–‡ï¼šABCDEFGHIJKLMNOPQRSTUVWXYZ

çµæŸã€‚`;
        
        // å‰µå»º Blob
        const blob = new Blob([textContent], { type: 'text/plain;charset=utf-8' });
        
        // å‰µå»º URL
        const url = URL.createObjectURL(blob);
        
        // å‰µå»ºä¸‹è¼‰é€£çµ
        const link = document.createElement("a");
        link.href = url;
        link.download = "test-file.txt";
        
        // è§¸ç™¼ä¸‹è¼‰
        link.click();
        
        // æ¸…ç† URL
        URL.revokeObjectURL(url);
        
        // èª¿ç”¨ downloadCalled (å¦‚æœå­˜åœ¨)
        if (typeof downloadCalled === 'function') {
          downloadCalled('test-file.txt');
        } else {
          console.log('downloadCalled function not available');
        }
      });

      // ç‚ºæŒ‰éˆ•4æ·»åŠ é»æ“Šäº‹ä»¶
      document.getElementById("blobImageDownloadBtn").addEventListener("click", function (e) {
        e.preventDefault();
        
        // å‰µå»º Canvas ä¸¦ç•«ä¸€å€‹æ›´è¤‡é›œçš„åœ–ç‰‡
        const canvas = document.createElement("canvas");
        canvas.width = 300;
        canvas.height = 300;
        const ctx = canvas.getContext("2d");
        
        // èƒŒæ™¯æ¼¸è®Š
        const gradient = ctx.createLinearGradient(0, 0, 300, 300);
        gradient.addColorStop(0, "#667eea");
        gradient.addColorStop(1, "#764ba2");
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, 300, 300);
        
        // ç•«ä¸€äº›å¹¾ä½•åœ–å½¢
        ctx.fillStyle = "#ffffff";
        ctx.fillRect(50, 50, 200, 200);
        
        ctx.fillStyle = "#ff6b6b";
        ctx.beginPath();
        ctx.arc(150, 150, 80, 0, 2 * Math.PI);
        ctx.fill();
        
        ctx.fillStyle = "#4ecdc4";
        ctx.fillRect(100, 100, 100, 100);
        
        // æ·»åŠ æ–‡å­—
        ctx.fillStyle = "#333333";
        ctx.font = "24px Arial";
        ctx.textAlign = "center";
        ctx.fillText("Canvas", 150, 80);
        ctx.fillText("Blob", 150, 220);
        ctx.fillText("Image", 150, 250);
        
        // å°‡ Canvas è½‰æ›ç‚º Blob
        canvas.toBlob(function(blob) {
          // å‰µå»º URL
          const url = URL.createObjectURL(blob);
          
          // å‰µå»ºä¸‹è¼‰é€£çµ
          const link = document.createElement("a");
          link.href = url;
          link.download = "canvas-blob-image.png";
          
          // è§¸ç™¼ä¸‹è¼‰
          link.click();
          
          // æ¸…ç† URL
          URL.revokeObjectURL(url);
          
          // èª¿ç”¨ downloadCalled (å¦‚æœå­˜åœ¨)
          if (typeof downloadCalled === 'function') {
            downloadCalled('canvas-blob-image.png');
          } else {
            console.log('downloadCalled function not available');
          }
        }, 'image/png');
      });

      // ç‚ºæŒ‰éˆ•5æ·»åŠ é»æ“Šäº‹ä»¶
      document.getElementById("blobJsonDownloadBtn").addEventListener("click", function (e) {
        e.preventDefault();
        
        // å‰µå»º JSON è³‡æ–™
        const jsonData = {
          "title": "WebView ä¸‹è¼‰æ¸¬è©¦ JSON æª”æ¡ˆ",
          "timestamp": new Date().toISOString(),
          "version": "1.0.0",
          "description": "é€™æ˜¯ä¸€å€‹ä½¿ç”¨ Blob API ä¸‹è¼‰çš„ JSON æ¸¬è©¦æª”æ¡ˆ",
          "features": [
            "Blob API æ”¯æ´",
            "JSON æ ¼å¼ä¸‹è¼‰",
            "ä¸­æ–‡å­—ç¬¦æ¸¬è©¦",
            "ç‰¹æ®Šç¬¦è™Ÿæ¸¬è©¦"
          ],
          "testData": {
            "numbers": [1, 2, 3, 4, 5],
            "boolean": true,
            "null_value": null,
            "nested_object": {
              "name": "æ¸¬è©¦ç‰©ä»¶",
              "type": "nested",
              "properties": {
                "color": "blue",
                "size": "medium",
                "tags": ["test", "json", "blob", "ä¸‹è¼‰"]
              }
            }
          },
          "specialCharacters": "!@#$%^&*()_+{}[]|\\:;\"'<>?,./~`",
          "unicode": "ğŸš€ ğŸ“± ğŸ’» ğŸ‰ âœ…",
          "status": "success"
        };
        
        // å°‡ JSON ç‰©ä»¶è½‰æ›ç‚ºå­—ä¸²
        const jsonString = JSON.stringify(jsonData, null, 2);
        
        // å‰µå»º Blob
        const blob = new Blob([jsonString], { type: 'application/json;charset=utf-8' });
        
        // å‰µå»º URL
        const url = URL.createObjectURL(blob);
        
        // å‰µå»ºä¸‹è¼‰é€£çµ
        const link = document.createElement("a");
        link.href = url;
        link.download = "test-data.json";
        
        // è§¸ç™¼ä¸‹è¼‰
        link.click();
        
        // æ¸…ç† URL
        URL.revokeObjectURL(url);
        
        // èª¿ç”¨ downloadCalled (å¦‚æœå­˜åœ¨)
        if (typeof downloadCalled === 'function') {
          downloadCalled('test-data.json');
        } else {
          console.log('downloadCalled function not available');
        }
      });
    </script>
  </body>
</html>
